<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Logging using ParallelLogger • ParallelLogger</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Logging using ParallelLogger">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ParallelLogger</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Logging.html">Logging using ParallelLogger</a>
    </li>
    <li>
      <a href="../articles/Parallel.html">Parallel execution using ParallelLogger</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/ParallelLogger/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Logging using ParallelLogger</h1>
                        <h4 data-toc-skip class="author">Martijn J.
Schuemie</h4>
            
            <h4 data-toc-skip class="date">2025-03-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/ParallelLogger/blob/HEAD/vignettes/Logging.Rmd" class="external-link"><code>vignettes/Logging.Rmd</code></a></small>
      <div class="hidden name"><code>Logging.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette describes how you can use the
<code>ParallelLogger</code> package to perform logging. Logging is the
activity of recording events that occur during an analysis in a log. The
log can be used for example for for debugging, profiling (understanding
performance bottlenecks), and audits.</p>
<div class="section level3">
<h3 id="terminology">Terminology<a class="anchor" aria-label="anchor" href="#terminology"></a>
</h3>
<ul>
<li>
<strong>Logger</strong>: An object that can receive
<strong>events</strong>, and writes them to a log. A logger has a
<strong>name</strong>, a prespecified <strong>event level</strong> (only
events at or above that level are logged), and one or more
<strong>appenders</strong>.</li>
<li>
<strong>Event</strong>: Consists of a message and an event
level.</li>
<li>
<strong>Event level</strong>: Each event has an associated level.
These levels (in ranked order) are
<ul>
<li>
<code>TRACE</code>: Events to mark the analysis has passed through
some code.</li>
<li>
<code>DEBUG</code>: Events to help understand the state of the code
(e.g. whether a variable has a value).</li>
<li>
<code>INFO</code>: Events typically displayed to the user to inform
of the progress.</li>
<li>
<code>WARN</code>: Events that indicate something probably requires
attention.</li>
<li>
<code>ERROR</code>: Events indicating something went wrong.</li>
<li>
<code>FATAL</code>: Events indicating something went wrong, causing
the analysis to terminate.</li>
</ul>
</li>
<li>
<strong>Appender</strong>: An object that writes to a destination,
for example the console or a file. An appender uses a
<strong>layout</strong> to format its messages. There currently are
three types of appenders:
<ul>
<li>
<strong>Console appender</strong>: Writes to the console, created
using the <code>createConsoleAppender</code> function.</li>
<li>
<strong>File appender</strong>: Writes to a file, created using the
<code>createFileAppender</code> function.</li>
<li>
<strong>E-mail appender</strong>: Sends an e-mail, created using the
<code>createEmailAppender</code> function.</li>
</ul>
</li>
<li>
<strong>Layout</strong>: Objects specifying the format in which the
log will be created. The following layouts are available:
<ul>
<li>
<code>layoutSimple</code>: Only outputs the message.</li>
<li>
<code>layoutTimestamp</code>: Adds the current time and date to the
message.</li>
<li>
<code>layoutStackTrace</code>: Adds the time and date, and full
stack trace to the message.</li>
<li>
<code>layoutParallel</code>: Includes the thread identifier, name of
the package and function raising the event, the current time and date,
the message level, and the message itself.</li>
<li>
<code>layoutErrorReport</code>: Creates a report for an event,
including the message, stack trace, and information about the run-time
environment such as the type of operating system, and installed R
packages.</li>
<li>
<code>layoutEmail</code>: This layout adds the thread ID and stack
trace to the message.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="creating-a-console-logger">Creating a console logger<a class="anchor" aria-label="anchor" href="#creating-a-console-logger"></a>
</h2>
<p>The code below demonstrates how one would create a logger that writes
all events at level <code>INFO</code> or greater to the console using a
layout with time stamp:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"SIMPLE"</span>,</span>
<span>                       threshold <span class="op">=</span> <span class="st">"INFO"</span>,</span>
<span>                       appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createConsoleAppender.html">createConsoleAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutTimestamp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="va">logger</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logTrace.html">logTrace</a></span><span class="op">(</span><span class="st">"This event is below the threshold (INFO)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logInfo.html">logInfo</a></span><span class="op">(</span><span class="st">"Hello world"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Hello world</span></span>
<span><span class="co">## 2021-02-23 09:04:06 Hello world</span></span></code></pre>
<p>Note that the message is displayed twice. This is because there is a
default logger that uses the simple layout and threshold = “INFO”, and
writes to console. We can remove this logger before registering our
logger to avoid duplication:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/clearLoggers.html">clearLoggers</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">logger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"SIMPLE"</span>,</span>
<span>                       threshold <span class="op">=</span> <span class="st">"INFO"</span>,</span>
<span>                       appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createConsoleAppender.html">createConsoleAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutTimestamp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="va">logger</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logInfo.html">logInfo</a></span><span class="op">(</span><span class="st">"Hello world"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2021-02-23 09:04:06 Hello world</span></span></code></pre>
<div class="section level3">
<h3 id="shorthand">Shorthand<a class="anchor" aria-label="anchor" href="#shorthand"></a>
</h3>
<p>A shorthand for creating a simple console logger is offered by the
<code>addDefaultConsoleLogger</code> function. The code</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDefaultConsoleLogger.html">addDefaultConsoleLogger</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"DEFAULT_CONSOLE_LOGGER"</span>,</span>
<span>                            threshold <span class="op">=</span> <span class="st">"INFO"</span>, </span>
<span>                            appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createConsoleAppender.html">createConsoleAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutSimple</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-a-file-logger">Creating a file logger<a class="anchor" aria-label="anchor" href="#creating-a-file-logger"></a>
</h2>
<p>Probably more useful is a file logger. In the code below, we
instantiate a logger that writes to file, using a threshold of
<code>TRACE</code> (so including all events), and using the layout for
parallel processing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logFileName</span> <span class="op">&lt;-</span> <span class="st">"log.txt"</span></span>
<span></span>
<span><span class="va">logger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"PARALLEL"</span>,</span>
<span>                       threshold <span class="op">=</span> <span class="st">"TRACE"</span>,</span>
<span>                       appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createFileAppender.html">createFileAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutParallel</span>,</span>
<span>                                                           fileName <span class="op">=</span> <span class="va">logFileName</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="va">logger</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logTrace.html">logTrace</a></span><span class="op">(</span><span class="st">"Executed this line"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logDebug.html">logDebug</a></span><span class="op">(</span><span class="st">"There are "</span>,  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/getLoggers.html">getLoggers</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">" loggers"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logInfo.html">logInfo</a></span><span class="op">(</span><span class="st">"Hello world"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2021-02-23 09:04:06 Hello world</span></span></code></pre>
<p>We can read the log file:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readChar.html" class="external-link">readChar</a></span><span class="op">(</span><span class="va">logFileName</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.info.html" class="external-link">file.info</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2021-02-23 09:04:06  [Main thread]   TRACE   evaluate    timing_fn   Executed this line</span></span>
<span><span class="co">## 2021-02-23 09:04:06  [Main thread]   DEBUG   evaluate    timing_fn   There are 2 loggers</span></span>
<span><span class="co">## 2021-02-23 09:04:06  [Main thread]   INFO    evaluate    timing_fn   Hello world</span></span></code></pre>
<p>And clean it up when we’re done:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="shorthand-1">Shorthand<a class="anchor" aria-label="anchor" href="#shorthand-1"></a>
</h3>
<p>A shorthand for creating the file logger detailed here is offered by
the <code>addDefaultFileLogger</code> function. The code</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span></span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"DEFAULT_FILE_LOGGER"</span>,</span>
<span>                            threshold <span class="op">=</span> <span class="st">"TRACE"</span>, </span>
<span>                            appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createFileAppender.html">createFileAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutParallel</span>, </span>
<span>                                                                fileName <span class="op">=</span> <span class="va">logFileName</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-an-error-report-logger">Creating an error report logger<a class="anchor" aria-label="anchor" href="#creating-an-error-report-logger"></a>
</h2>
<p>A special case of a file logger is an error report logger. Rather
than logging one event per row, the error report logger creates a single
file dedicated to one event. As the name implies, this makes most sense
for fatal error events. The error report contains the error message,
stack trace, and information on the run-time environment, including the
type of operating system and installed R packages. The idea is that this
report can be shared between someone running the code and someone
debugging the code remotely.</p>
<p>The error report will be overwritten if a new error occurs, unless
the new error occurs within 60 seconds of the creation of the error
report. The reason for this delay is that it may be that a sub-thread
throws an error, which we’d want to catch, followed shortly after by an
error in the main thread, which we’d also like to catch. Both threads
will then provide their error messages and stack trace, but only the
main thread will include the information about the run-time environment,
to avoid redundancy.</p>
<div class="section level3">
<h3 id="shorthand-2">Shorthand<a class="anchor" aria-label="anchor" href="#shorthand-2"></a>
</h3>
<p>It is recommended to simply always use the shorthand for creating an
error report logger:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDefaultErrorReportLogger.html">addDefaultErrorReportLogger</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>which is equivalent to</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fileName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"errorReportR.txt"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"DEFAULT_ERRORREPORT_LOGGER"</span>,</span>
<span>                            threshold <span class="op">=</span> <span class="st">"FATAL"</span>,</span>
<span>                            appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createFileAppender.html">createFileAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutErrorReport</span>,</span>
<span>                                                                fileName <span class="op">=</span> <span class="va">fileName</span>,</span>
<span>                                                                overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                                                expirationTime <span class="op">=</span> <span class="fl">60</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-an-e-mail-logger">Creating an e-mail logger<a class="anchor" aria-label="anchor" href="#creating-an-e-mail-logger"></a>
</h2>
<p>We can also add a logger that sends an e-mail whenever an event is
logged above the specified threshold. For example, for a process running
on a remote machine it might be useful to receive e-mails of fatal
events:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mailSettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>from <span class="op">=</span> <span class="st">"someone@gmail.com"</span>,</span>
<span>to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"someone_else@gmail.com"</span><span class="op">)</span>,</span>
<span>smtp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>host.name <span class="op">=</span> <span class="st">"smtp.gmail.com"</span>,</span>
<span>port <span class="op">=</span> <span class="fl">465</span>,</span>
<span>user.name <span class="op">=</span> <span class="st">"someone@gmail.com"</span>,</span>
<span>passwd <span class="op">=</span> <span class="st">"super_secret!"</span>,</span>
<span>ssl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>authenticate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>send <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">logger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"EMAIL"</span>,</span>
<span>threshold <span class="op">=</span> <span class="st">"FATAL"</span>,</span>
<span>appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createEmailAppender.html">createEmailAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutEmail</span>,</span>
<span>mailSettings <span class="op">=</span> <span class="va">mailSettings</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="va">logger</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logFatal.html">logFatal</a></span><span class="op">(</span><span class="st">"No more data to process"</span><span class="op">)</span></span></code></pre></div>
<p>Note that the <code>mailSettings</code> object will be passed on to
the <code>send.mail</code> function in the <code>mailR</code> package,
so for more details see <code>?mailR::send.mail</code>’</p>
<div class="section level3">
<h3 id="shorthand-3">Shorthand<a class="anchor" aria-label="anchor" href="#shorthand-3"></a>
</h3>
<p>A shorthand for creating the e-mail logger detailed here is offered
by the <code>addDefaultEmailLogger</code> function. The code</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addDefaultEmailLogger.html">addDefaultEmailLogger</a></span><span class="op">(</span><span class="va">mailSettings</span><span class="op">)</span></span></code></pre></div>
<p>is equivalent to</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/registerLogger.html">registerLogger</a></span><span class="op">(</span><span class="fu"><a href="../reference/createLogger.html">createLogger</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"DEFAULT_EMAIL_LOGGER"</span>,</span>
<span>threshold <span class="op">=</span> <span class="st">"FATAL"</span>,</span>
<span>appenders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/createEmailAppender.html">createEmailAppender</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="va">layoutEmail</span>,</span>
<span>mailSettings <span class="op">=</span> <span class="va">mailSettings</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="messages-warnings-and-fatal-errors">Messages, warnings and fatal errors<a class="anchor" aria-label="anchor" href="#messages-warnings-and-fatal-errors"></a>
</h2>
<p>All R warnings and errors are automatically logged, and therefore do
not require explicit logging. For example:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/clearLoggers.html">clearLoggers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Hello"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"Danger!"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This throws a warning:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="st">'a'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This throws an error:</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">b</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readChar.html" class="external-link">readChar</a></span><span class="op">(</span><span class="va">logFileName</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.info.html" class="external-link">file.info</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2021-02-23 09:04:09  [Main thread]   WARN    evaluate    timing_fn   Hello</span></span>
<span><span class="co">## 2021-02-23 09:04:09  [Main thread]   WARN    evaluate    timing_fn   Danger!</span></span>
<span><span class="co">## 2021-02-23 09:04:09  [Main thread]   WARN    evaluate    timing_fn   Warning: NAs introduced by coercion</span></span>
<span><span class="co">## 2021-02-23 09:04:09  [Main thread]   FATAL   evaluate    timing_fn   Error: object a not found</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="logging-when-parallel-processing">Logging when parallel processing<a class="anchor" aria-label="anchor" href="#logging-when-parallel-processing"></a>
</h2>
<p>The logging functions are designed to work with the parallel
processing functions included in this package. The
<code>layoutParallel</code> records thread identifiers, making it
possible to later untangle the various threads. Below is a simple
example:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/clearLoggers.html">clearLoggers</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Clean up the loggers from the previous example</span></span>
<span></span>
<span><span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ParallelLogger</span><span class="fu">::</span><span class="fu"><a href="../reference/logInfo.html">logInfo</a></span><span class="op">(</span><span class="st">"The value of x is "</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="co"># Do something</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">6</span><span class="op">)</span></span>
<span>    <span class="fu">ParallelLogger</span><span class="fu">::</span><span class="fu"><a href="../reference/logDebug.html">logDebug</a></span><span class="op">(</span><span class="st">"X equals 6"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterApply.html">clusterApply</a></span><span class="op">(</span><span class="va">cluster</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="va">fun</span>, progressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/stopCluster.html">stopCluster</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readChar.html" class="external-link">readChar</a></span><span class="op">(</span><span class="va">logFileName</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.info.html" class="external-link">file.info</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2021-02-23 09:04:09  [Main thread]   TRACE   evaluate timing_fn Initiating cluster with 3 threads</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 1]  TRACE       Thread 1 initiated</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 2]  TRACE       Thread 2 initiated</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 3]  TRACE       Thread 3 initiated</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 1]  INFO        The value of x is 1</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 2]  INFO        The value of x is 2</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 1]  INFO        The value of x is 4</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 2]  INFO        The value of x is 5</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 3]  INFO        The value of x is 6</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 1]  INFO        The value of x is 7</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 2]  INFO        The value of x is 8</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 1]  INFO        The value of x is 9</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 2]  INFO        The value of x is 10</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Main thread]   TRACE   evaluate    timing_fn Stopping cluster</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 1]  TRACE       Thread 1 terminated</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 3]  TRACE       Thread 3 terminated</span></span>
<span><span class="co">## 2021-02-23 09:04:13  [Thread 2]  TRACE       Thread 2 terminated</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="creating-loggers-in-functions">Creating loggers in functions<a class="anchor" aria-label="anchor" href="#creating-loggers-in-functions"></a>
</h2>
<p>Creating a logger right before starting a very complex computation is
probably a good idea, to capture information that may help to debug when
things go wrong. Although having multiple loggers simultaneously should
work fine, it probably makes sense to only invoke loggers at the highest
level. So instead of</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subSubTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="st">"subSubTaskLog.txt"</span><span class="op">)</span></span>
<span>  <span class="co"># do something</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">subTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="st">"subTaskLog.txt"</span><span class="op">)</span></span>
<span>  <span class="co"># do something</span></span>
<span>  <span class="fu">subSubTask</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mainTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="st">"mainTaskLog.txt"</span><span class="op">)</span></span>
<span>  <span class="co"># do something</span></span>
<span>  <span class="fu">subTask</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>it would be better to have only one logger:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subSubTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># do something</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">subTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># do something</span></span>
<span>  <span class="fu">subSubTask</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mainTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="st">"log.txt"</span><span class="op">)</span></span>
<span>  <span class="co"># do something</span></span>
<span>  <span class="fu">subTask</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Also, as a courtesy to the user, please clean up the logger after the
function is finished. By using <code>on.exit</code>, we can ensure the
logger is always closed, even when the function stops unexpectedly
(e.g. due to an error):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mainTask</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/addDefaultFileLogger.html">addDefaultFileLogger</a></span><span class="op">(</span><span class="st">"log.txt"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="../reference/unregisterLogger.html">unregisterLogger</a></span><span class="op">(</span><span class="st">"DEFAULT_FILE_LOGGER"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># do something</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="shiny-log-viewer">Shiny log viewer<a class="anchor" aria-label="anchor" href="#shiny-log-viewer"></a>
</h2>
<p>A Shiny app for viewing a log file created using the
<code>layoutParallel</code> is included in the package. To explore the
log created in the prior example, run</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/launchLogViewer.html">launchLogViewer</a></span><span class="op">(</span><span class="va">logFileName</span><span class="op">)</span></span></code></pre></div>
<p>to launch the viewer shown in Figure 1.</p>
<div class="float">
<img src="shinyApp.png" alt="Shiny log viewer app"><div class="figcaption">Shiny log viewer app</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martijn Schuemie, Marc Suchard.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
